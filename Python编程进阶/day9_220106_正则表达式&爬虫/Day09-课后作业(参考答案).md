[TOC]

## Day09-正则表示式vs爬虫程序

### 今日课程学习目标

```shell
熟悉正则表达式的基本语法
熟悉re正则模块中常用方法是使用
常握使用正则提取指定分组的数据
理解正则中的贪婪模式和非贪婪模式
熟悉 FastAPI 提取URL地址数据
熟悉爬虫的概念和作用
```

### 今日课程内容大纲

```shell
# 1. 正则表达式
	正则表达式的作用
	正则表达式的语法
		匹配单个字符
		匹配多个字符
		正则分组
	re正则模块的使用
	贪婪模式vs非贪婪模式
# 2. 爬虫程序
	FastAPI返回图片数据
	FastAPI提取URL地址数据
	爬虫的概念和作用
	requests简单使用
```

### 基础概念题

#### 1. 什么是正则表达式？正则表达式有什么作用？

**参考答案:**

```
正则表达式是一种字符串的匹配模式，可以用来对字符串进行匹配、提取、替换等操作。

正则表达式的功能：
	数据验证（表单验证、如手机、邮箱、IP地址）
	数据检索（数据检索、数据抓取）
	数据隐藏（135****6235 王先生）
	数据过滤（论坛敏感关键词过滤）
```

#### 2. 正则的贪婪模式和非贪婪模式是什么？

**参考答案**：

```shell
贪婪模式：在整个表达式匹配成功的前提下，尽可能多的匹配
非贪婪模式：在整个表达式匹配成功的前提下，尽可能少的匹配

正则中的量词包括：{m,n}、?、*和+，这些量词默认都是贪婪模式的匹配，可以在这些量词后面加?将其变为非贪婪模式。
```



#### 3. 什么是爬虫？爬虫有什么作用？

**参考答案:**

```shell
 爬虫是一个程序，可以模拟浏览器发送请求，获取响应。
 作用：爬虫是数据分析中，进行数据采集的一种方式。
```



#### 4. 爬虫的工作流程是什么？

**参考答案:**

```
1. 向起始的 url 地址发送请求，并获取响应数据
2. 对响应内容进行提取
3. 如果提取 url，则继续发送请求获取响应
4. 如果提取数据，将数据进行保存
```



### 代码练习题

#### 1. 完成课上的代码【3遍】



#### 2. 正则练习-匹配手机号

提示用户输入手机号码，然后使用正则判断用户的输入是否符合手机号的格式。

**参考答案**：

```python
import re

mobile = input('请输入手机号')

# 进行正则匹配
res = re.search(r'^1[3-9]\d{9}$', mobile)

if res:
    print('符合手机号格式！')
else:
    print('不符合手机号格式！')
```



#### 3. 正则练习-判断全小写

提示用户输入内容，然后使用正则判断用户的输入是否是全小写字母。

**参考答案**：

```python
import re

content = input('请输入内容：')

# 进行正则匹配
res = re.search(r'^[a-z]+$', content)

if res:
    print('输入全为小写字母！')
else:
    print('输入不全为小写字母！')
```



#### 4. 正则练习-提取手机号

创建一个文件 stu.txt，内容如下：

```text
smart,18,13155667788
david,20,13377881010
lucy,21,15367892103
```

读取该文件的内容，使用正则从中提取出所有手机号码。

**参考答案**：

```python
import re

# 读取文件内容
with open('./stu.txt', 'r', encoding='utf8') as f:
    content = f.read()

    # 使用正则匹配手机号
    mobile_list = re.findall(r'1[3-9]\d{9}', content)

    # 打印匹配的内容
    print(mobile_list)
```



#### 5. 正则练习-分组提取数据

有字符串内容如下，使用正则从中提取出`大数据分析`文字

```python
my_str = """
    <!DOCTYPE html>
    <html> 
    <head>   
        <title>徐清风</title> 
    <head> 
    <body>   
        <h2>     
            <em>大数据分析</em>
        </h2> 
    </body>
    </html>
    """
```

**参考答案**：

```python
import re

my_str = """
    <!DOCTYPE html>
    <html> 
    <head>   
        <title>徐清风</title> 
    <head> 
    <body>   
        <h2>     
            <em>大数据分析</em>
        </h2> 
    </body>
    </html>
    """

# 进行字符串匹配
re_obj = re.search(r'<em>(?P<text>.*)</em>', my_str)

# 根据分组别名获取指定分组匹配的内容
result = re_obj.group('text')
print(result)
```



#### 6. 正则练习-隐藏手机号

将如下手机号的中间4位替换为 `****`

```python
my_str = '13155661013'
```

**参考答案**：

```python
import re

my_str = '13155661013'

# \1：引用第一个分组匹配的内容
# \2：引用第二个分组匹配的内容
new_str = re.sub(r'(\d{3})\d{4}(\d{4})', r'\1****\2', my_str)
print(new_str)
```
